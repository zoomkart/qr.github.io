<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QR Code Reader | Made by Rao Jatin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
    #reader video { width: 100% !important; border-radius: 1rem; }
    #scan-btn { animation: pulse 2s infinite; }
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.9; }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-white via-blue-50 to-blue-100 min-h-screen flex flex-col text-gray-800">

  <!-- Loading -->
  <div id="loading" class="fixed inset-0 bg-white z-50 flex flex-col items-center justify-center transition-opacity duration-500">
    <div class="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"></div>
    <h1 class="text-xl font-bold">Initializing QR Scanner...</h1>
  </div>

  <main class="flex-grow container mx-auto px-4 py-8 flex flex-col items-center">
    <h1 class="text-4xl font-bold text-center mb-2">QR Code Reader</h1>
    <p class="text-center text-gray-500 mb-6">Scan any QR Code using your camera</p>

    <div id="start-section" class="text-center">
      <button id="scan-btn" class="px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
        ðŸš€ Start Scanning
      </button>
      <p class="text-sm text-gray-500 mt-2">Allow camera permission when asked</p>
    </div>

    <div id="reader" class="hidden w-full max-w-md mt-6 rounded-2xl shadow-lg border-2 border-blue-200"></div>

    <!-- Result -->
    <div id="result-container" class="hidden mt-6 w-full max-w-md bg-white rounded-xl p-6 shadow-lg border border-gray-200">
      <h2 class="text-xl font-semibold mb-3">Scan Result</h2>
      <div id="result" class="bg-gray-50 p-4 rounded-md break-words text-sm mb-4"></div>
      <div class="flex flex-wrap gap-3">
        <button id="copy-btn" class="px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-md">ðŸ“‹ Copy</button>
        <button id="open-btn" class="px-4 py-2 bg-green-100 hover:bg-green-200 text-green-800 rounded-md hidden">ðŸ”— Open Link</button>
        <button id="new-scan-btn" class="ml-auto px-4 py-2 bg-indigo-100 hover:bg-indigo-200 text-indigo-800 rounded-md">ðŸ”„ New Scan</button>
      </div>
    </div>
  </main>

  <footer class="py-6 text-center text-sm text-gray-400">
    Website Made by Rao Jatin Â© 2025
  </footer>

  <!-- Script -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const loading = document.getElementById('loading');
      const scanBtn = document.getElementById('scan-btn');
      const reader = document.getElementById('reader');
      const resultContainer = document.getElementById('result-container');
      const resultDiv = document.getElementById('result');
      const copyBtn = document.getElementById('copy-btn');
      const openBtn = document.getElementById('open-btn');
      const newScanBtn = document.getElementById('new-scan-btn');
      const startSection = document.getElementById('start-section');

      let qrScanner;
      let currentCameraId;

      // Hide loader after 2 sec
      setTimeout(() => {
        loading.classList.add('opacity-0');
        setTimeout(() => loading.style.display = 'none', 500);
      }, 2000);

      // Handle Scan Button
      scanBtn.addEventListener('click', async () => {
        startSection.classList.add('hidden');
        reader.classList.remove('hidden');

        qrScanner = new Html5Qrcode("reader");

        try {
          const devices = await Html5Qrcode.getCameras();
          if (devices && devices.length) {
            currentCameraId = devices[0].id;

            qrScanner.start(
              currentCameraId,
              { fps: 10, qrbox: { width: 250, height: 250 } },
              (decodedText) => {
                qrScanner.stop().then(() => {
                  reader.classList.add('hidden');
                  resultContainer.classList.remove('hidden');
                  resultDiv.textContent = decodedText;

                  try {
                    new URL(decodedText);
                    openBtn.classList.remove('hidden');
                    openBtn.onclick = () => window.open(decodedText, '_blank');
                  } catch {
                    openBtn.classList.add('hidden');
                  }
                });
              },
              (errorMessage) => {
                console.warn("QR Scan Error:", errorMessage);
              }
            ).catch(err => {
              console.error("Camera start failed:", err);
              alert("Camera access failed. Please check permission or use HTTPS.");
              startSection.classList.remove('hidden');
              reader.classList.add('hidden');
            });

          } else {
            alert("No camera devices found.");
            startSection.classList.remove('hidden');
          }
        } catch (err) {
          console.error("Camera init error:", err);
          alert("Error accessing camera: " + err.message);
          startSection.classList.remove('hidden');
        }
      });

      // Copy Button
      copyBtn.addEventListener('click', () => {
        navigator.clipboard.writeText(resultDiv.textContent).then(() => {
          copyBtn.textContent = "âœ… Copied!";
          setTimeout(() => copyBtn.textContent = "ðŸ“‹ Copy", 2000);
        });
      });

      // New Scan
      newScanBtn.addEventListener('click', () => {
        resultContainer.classList.add('hidden');
        startSection.classList.remove('hidden');
        resultDiv.textContent = "";
        openBtn.classList.add('hidden');
      });
    });
  </script>
</body>
</html>